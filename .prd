MOONLANDING FEATURE PARITY PRD
==============================
Goal: Achieve 1:1 feature parity with friday-staging + myworkreview-staging.
Foundation: Clean buildless codebase, 156 essential files, zero-build tsx architecture.
Status: Executing Waves 4-7 with hierarchical Phase-based approach

STRATEGY: Start with Phase 0 (Foundation) which establishes critical infrastructure
(Dialog Registry, List Grouping, Search, Component Library, Global Tags) that unblocks
21+ items. Then execute Quick Wins (18 items, 3-4 hours), followed by Waves 4-5 in
parallel groups, then Wave 6 generalization, then Wave 7 cleanup.

Estimated timeline: 20-26 hours wall time with parallelism (2.5-3.5 days)

================================================================================
PHASE 0: FOUNDATION ✅ COMPLETE
================================================================================
Completed: Dialog Registry, List Grouping, Search, Component Library, Global Tags
All 5 foundation items implemented and ready to unblock Phases 1-4

================================================================================
PHASE 1A: QUICK WINS (Config-only additions, ~45 min total)
================================================================================

These 9 items require only master-config.yml additions - no code changes:

- [ ] Q1-CONFIG-AUTH: Password reset flow config
      Add to master-config.yml: password_reset_endpoint, email_template_id
      (W4-F-AUTH-03 full implementation after config)
      Time: 10 min

- [ ] Q2-CONFIG-FEE: Engagement fee split field schema
      Add to master-config.yml: engagement.fee_split as JSON field with sub-fields
      (W4-F-FEE-01 full implementation after config)
      Time: 5 min

- [ ] Q3-CONFIG-IDLE: Session idle config
      Add to master-config.yml: session.idle_timeout_ms, idle_warning_dialog_config
      (W4-F-AUTH-06 full implementation after config)
      Time: 5 min

- [ ] Q4-CONFIG-RFI-TEMPLATE: RFI template dropdown config
      Add to master-config.yml: rfi.templates list
      (W4-F-RFI-28 full implementation after config)
      Time: 5 min

- [ ] Q5-CONFIG-NOTIFICATION: Notification settings schema
      Add to master-config.yml: notification trigger types, engagement notification settings
      (W4-F-NOTIF-01/02 full implementation after config)
      Time: 5 min

- [ ] Q6-CONFIG-REVIEW-TABS: Review list tabs config
      Add to master-config.yml: review.tabs (Active, Priority, History, Archive)
      (W5-M-REV-01, W5-M-HOME-01 full implementation after config)
      Time: 5 min

- [ ] Q7-CONFIG-TENDER: Tender fields schema
      Add to master-config.yml: tender entity fields and defaults
      (W5-M-TENDER-01/02 full implementation after config)
      Time: 5 min

- [ ] Q8-CONFIG-CHECKLIST: Checklist template structure
      Add to master-config.yml: checklist.templates structure
      (W5-M-CHECK-01 full implementation after config)
      Time: 5 min

- [ ] Q9-CONFIG-SETTINGS: Settings page sections config
      Add to master-config.yml: settings navigation and section order
      (W4-F-SET-01, W5-M-SET-01+ full implementation after config)
      Time: 5 min

================================================================================
PHASE 1B: UNBLOCKED WAVE 4 (Can execute immediately, 2-3 hours)
================================================================================

These 15 items don't depend on Phase 0 - start in parallel:

- [ ] U1-W4-F-AUTH-03: Password reset page + API (after Q1 config)
      Unblocked: No dependencies on Phase 0 systems
      Time: 30 min

- [ ] U2-W4-F-FEE-01: Engagement fee split (after Q2 config)
      Unblocked: Pure schema + UI tab addition
      Time: 45 min

- [ ] U3-W4-F-AUTH-06: Auto-logout idle detection (after Q3 config)
      Unblocked: Pure client-side implementation
      Time: 45 min

- [ ] U4-W4-F-PDF-01: PDF Editor dialog wrapper
      Unblocked: Wraps existing PDF viewer
      Time: 45 min

- [ ] U5-W4-F-PDF-09: PDF Tip/TipContainer (highlight creation tooltip)
      Unblocked: Pure UI component
      Time: 30 min

- [ ] U6-W4-F-PDF-19: ConvertDataUrlFile utility
      Unblocked: Pure utility function
      Time: 20 min

- [ ] U7-W4-F-PDF-21: MobileResizableRectangle
      Unblocked: Touch device resize for highlights
      Time: 40 min

- [ ] U8-W4-F-LIFE-04: Stage selection UI (visual progress pipeline)
      Unblocked: Pure UI component, no data dependencies
      Time: 40 min

- [ ] U9-W4-F-UI-09: Linear progress label component
      Unblocked: Pure CSS/HTML component
      Time: 20 min

- [ ] U10-W4-F-UI-10: Circular progress label (SVG)
      Unblocked: Pure SVG component
      Time: 25 min

- [ ] U11-W4-F-UI-06: Date choice dialogs
      Unblocked: HTML5 date input wrapper
      Time: 30 min

- [ ] U12-W4-F-UI-05: Drag-and-drop reordering (HTML5 drag API)
      Unblocked: Pure HTML5 API usage
      Time: 45 min

- [ ] U13-W4-F-FILE-06: User CV upload
      Unblocked: File upload endpoint + UI
      Time: 30 min

- [ ] U14-W4-F-MISC-01: Global tags system (complete src/ui/global-tags.js)
      Unblocked: After P0-0.5, pure utility
      Time: 45 min

- [ ] U15-W4-F-BUILD-01: Build/deployment logs page
      Unblocked: Route + page rendering
      Time: 30 min

================================================================================
PHASE 1C: BLOCKED WAVE 4 (Requires Phase 0 + Dialog Registry, 8-10 hours)
================================================================================

These 43 Wave 4 items are grouped into 4 parallel execution groups.
All depend on P0-0.2 (Dialog Registry) being complete.

--- GROUP 1A: Engagement Management (2 hours) ---
Depends on: P0-0.1 (list grouping), P0-0.2 (dialog registry)

- [ ] G1A-1: W4-F-ENG-05: Engagement list grouping + detail panels
      Implement: groupBy parameter for stage/year/client in renderEntityList
      Time: 1 hour
      Blocks: None (foundational)

- [ ] G1A-2: W4-F-ENG-08: Engagement search field
      Implement: Real-time search filtering in entity list
      Time: 45 min

- [ ] G1A-3: W4-F-ENG-09: Client engagement view
      Implement: Client-specific layout in page-handler.js
      Time: 15 min (config-driven)

--- GROUP 1B: Engagement Lifecycle (2 hours) ---
Depends on: P0-0.2 (dialog registry), P0-0.4 (component library for stage UI)

- [ ] G1B-1: W4-F-LIFE-02: Stage transition dialog
      Implement: Dialog registry entry + stage pipeline UI + reason input
      Time: 1 hour

- [ ] G1B-2: W4-F-CLIENT-06: Client dashboard
      Implement: Dashboard stats renderer
      Time: 45 min

- [ ] G1B-3: W4-F-NOTIF-01/02: Notification settings
      Implement: Dialog registry entries for notification config
      Time: 15 min (config + registry)

--- GROUP 1C: Team & Client Management (2 hours) ---
Depends on: P0-0.2 (dialog registry), P0-0.4 (component library for avatars)

- [ ] G1C-1: W4-F-TEAM-01: Team assignment dialog
      Implement: Dialog registry entry + user multi-select + avatars
      Time: 1 hour

- [ ] G1C-2: W4-F-TEAM-02: Team selector
      Implement: Extend dialog from TEAM-01 to form fields
      Time: 15 min

- [ ] G1C-3: W4-F-TEAM-03: Team avatar group display
      Implement: Component library entry + rendering
      Time: 15 min

- [ ] G1C-4: W4-F-CLIENT-07/08/09/10: Client management dialogs
      Implement: 4 dialog registry entries (manage users, replace user, test email, risk assessment)
      Time: 30 min (template-driven from registry)

--- GROUP 1D: RFI, Letters, Files, Misc (4 hours) ---
Depends on: P0-0.2 (dialog registry), P0-0.1 (list grouping)

RFI Features (2.5 hours):
- [ ] G1D-1: W4-F-RFI-07/08: RFI section CRUD + drag-drop reorder
      Implement: Section management UI + drag-drop
      Time: 1 hour

- [ ] G1D-2: W4-F-RFI-10: RFI question edit dialog
      Implement: Dialog registry entry
      Time: 15 min

- [ ] G1D-3: W4-F-RFI-16/17/18: RFI assignment dialogs (3x)
      Implement: 3 dialog registry entries
      Time: 15 min

- [ ] G1D-4: W4-F-RFI-20/21: RFI response attachment preview + lazy load
      Implement: Component + lazy load utility
      Time: 30 min

- [ ] G1D-5: W4-F-RFI-22/23: RFI report + reminder dialogs
      Implement: Report renderer + dialog registry
      Time: 30 min

- [ ] G1D-6: W4-F-RFI-30: RFI DataGrid grouping
      Implement: Use P0-0.1 grouping
      Time: 15 min

- [ ] G1D-7: W4-F-RFI-31/32: Toggle hide + badge count
      Implement: Simple UI toggles
      Time: 20 min

- [ ] G1D-8: W4-F-RFI-33/34/35: RFI item/attach dialogs
      Implement: 3 dialog registry entries
      Time: 20 min

- [ ] G1D-9: W4-F-RFI-36/37: Response choice box + color picker
      Implement: Component library entries
      Time: 20 min

Letters & Notification (30 min):
- [ ] G1D-10: W4-F-LETTER-01/02: Engagement letter dialog + upload
      Implement: 2 dialog registry entries
      Time: 30 min

Files & Search (45 min):
- [ ] G1D-11: W4-F-FILE-03/04/07/08: File features (zip, picker, preview)
      Implement: File utilities + dialog entries
      Time: 45 min

- [ ] G1D-12: W4-F-SEARCH-01: Engagement file search
      Implement: Search dialog + filtering
      Time: 15 min

Import/Export & Post-RFI (30 min):
- [ ] G1D-13: W4-F-IMPORT-01/PUSH-01: Internal linking equivalents
      Implement: Simple config to enable internal references
      Time: 15 min

- [ ] G1D-14: W4-F-POSTRFI-02/03: Post-RFI journal + file upload
      Implement: Dialog + file upload
      Time: 15 min

Settings (30 min):
- [ ] G1D-15: W4-F-SET-01/07/12/13: Settings pages
      Implement: Settings renderer for each section
      Time: 30 min

UI Components (15 min):
- [ ] G1D-16: W4-F-UI-17: Engagement card item view
      Implement: Card layout for list view
      Time: 15 min

Email (15 min):
- [ ] G1D-17: W4-F-EMAIL-03: Email receive dialog
      Implement: Dialog entry
      Time: 15 min

================================================================================
PHASE 2: WAVE 5 (MWR Feature Parity, 6-8 hours, parallel with Wave 4)
================================================================================

Depends on: P0-0.2 (Dialog Registry), P0-0.1 (List Grouping), P0-0.4 (Components)
Grouped into 6 parallel execution blocks:

--- GROUP 2A: Review Management (1.5 hours) ---

- [ ] G2A-1: W5-M-REV-01/02/05/06: Review list tabs + create dialog + templates
      Implement: Tab UI + dialog registry entries
      Time: 1.5 hours

--- GROUP 2B: Home & Dashboard (1 hour) ---

- [ ] G2B-1: W5-M-HOME-01/02: Home tabs + MWR-specific layout
      Implement: Tab UI + review-focused dashboard
      Time: 1 hour

--- GROUP 2C: Collaboration & Checklists (1.5 hours) ---

- [ ] G2C-1: W5-M-COLLAB-01/03: Collaborator dialog + expiry UI
      Implement: Dialog registry entries
      Time: 45 min

- [ ] G2C-2: W5-M-CHECK-01/06: Checklist templates + push
      Implement: Template UI + internal linking
      Time: 45 min

--- GROUP 2D: Status & Flags (1.5 hours) ---

- [ ] G2D-1: W5-M-FLAG-01/TAG-01/VALUE-01/DATE-01: Flag, tag, value, date dialogs
      Implement: 4 dialog registry entries
      Time: 45 min

- [ ] G2D-2: W5-M-STATUS-01/02/03: Open/close, private, bulk resolve
      Implement: Toggle UI + bulk action
      Time: 45 min

--- GROUP 2E: Lists & Search (1 hour) ---

- [ ] G2E-1: W5-M-GROUP-01/HIDE-01/SEARCH-01: Review list grouping, hide, search
      Implement: Use P0-0.1 + P0-0.3
      Time: 1 hour

--- GROUP 2F: Sections, Mobile, Files, Tender, Settings (1.5 hours) ---

- [ ] G2F-1: W5-M-SECT-01/02: Review sections + reports
      Implement: Sections UI + report renderer
      Time: 45 min

- [ ] G2F-2: W5-M-MOB-01/02: Mobile review/engagement cards
      Implement: Responsive card layouts
      Time: 15 min

- [ ] G2F-3: W5-M-PDF-07/08/16/17/18: PDF attachment features
      Implement: Component library entries
      Time: 30 min

- [ ] G2F-4: W5-M-FILE-02/05/06/07/08: File attachment features
      Implement: Bars + dialogs
      Time: 15 min

- [ ] G2F-5: W5-M-TENDER-01/02: Tender dialogs + holder
      Implement: 2 dialog entries
      Time: 15 min

- [ ] G2F-6: W5-M-SET-01/02/03/05/08: Settings pages
      Implement: Settings renderers
      Time: 30 min

- [ ] G2F-7: W5-M-NOTIF-01: Review notification dialog
      Implement: Dialog entry
      Time: 15 min

- [ ] G2F-8: W5-M-UI-01/02/12/13/17: UI components (sidebar, tooltips, response, attachment, panel)
      Implement: Component library entries
      Time: 30 min

- [ ] G2F-9: W5-M-MISC-01/04/06/07/11/ARCHIVE-01: Tags, calcs, dialogs, archive
      Implement: Utility functions + dialog entries
      Time: 30 min

================================================================================
PHASE 3: WAVE 6 (Generalization & Code Reduction, 4-6 hours)
================================================================================

Depends on: W4 and W5 completion (all features implemented)

- [ ] W6-GEN-01: Generalize dialog system
      Status: Partially done by P0-0.2 (Dialog Registry)
      Remaining: Consolidate all dialog files into single dialog-engine.js + config
      Time: 1.5 hours

- [ ] W6-GEN-02: Generalize list rendering
      Status: Partially done by P0-0.1 (List Grouping)
      Remaining: Consolidate renderEntityList variants into single generic renderer
      Time: 1 hour

- [ ] W6-GEN-03: Generalize form rendering
      Status: Already partially in page-handler.js
      Remaining: Complete so no entity-specific form code exists
      Time: 1 hour

- [ ] W6-GEN-04: Generalize detail view rendering
      Status: Already partially in page-handler.js
      Remaining: Complete so no entity-specific detail code exists
      Time: 1 hour

- [ ] W6-GEN-05: Consolidate renderer files
      Split renderer.js (849 lines) into <200 line modules
      Time: 1.5 hours

- [ ] W6-GEN-06: Consolidate dialog files (completed by GEN-01)
      Status: Already consolidated in P0-0.2 + GEN-01
      Time: 0 (done)

- [ ] W6-GEN-07: Reduce API routes
      Verify domain-specific routes (friday/*, mwr/*) not needed
      Time: 30 min

- [ ] W6-GEN-08: Reduce config files
      Consolidate spec-builder.js, constants.js, env.js, theme-config.js, etc.
      Time: 1.5 hours

- [ ] W6-GEN-09: Reduce lib files
      Consolidate pdf-*.js, date-utils.js, utils.js
      Time: 1 hour

================================================================================
PHASE 4: WAVE 7 (Final Cleanup & Verification, 3-4 hours)
================================================================================

Depends on: W6 completion

- [ ] W7-CLEAN-01: Remove all comments from code
      Time: 30 min (automated scan + manual review)

- [ ] W7-CLEAN-02: Remove all hardcoded values
      Time: 1 hour

- [ ] W7-CLEAN-03: Ensure all files <200 lines
      Time: 1.5 hours (split oversized files)

- [ ] W7-CLEAN-04: Remove duplicate code
      Time: 1 hour

- [ ] W7-CLEAN-05: Update CLAUDE.md
      Time: 45 min

- [ ] W7-CLEAN-06: Update package.json
      Time: 30 min

- [ ] W7-CLEAN-07: Final file count audit
      Time: 30 min

- [ ] W7-VERIFY-01: Start server and verify
      Time: 1 hour

- [ ] W7-VERIFY-02: Verify Friday user flows
      Time: 2-3 hours

- [ ] W7-VERIFY-03: Verify MWR user flows
      Time: 2-3 hours

================================================================================
EXECUTION STRATEGY
================================================================================

1. **Phase 0 (Foundation)** - Execute items 0.2, 0.1, 0.3, 0.4, 0.5 in parallel
   - P0-0.2 (Dialog Registry) is CRITICAL PATH - start immediately
   - P0-0.1/0.3/0.4/0.5 can run in parallel with 0.2
   - Wall time: 3-4 hours (2-3 with parallelism)

2. **Phase 1A+1B (Quick Wins + Unblocked)** - Immediate parallel execution
   - Q1-Q9 config additions: 45 min
   - U1-U15 unblocked items: 2-3 hours
   - Can execute in parallel with Phase 0
   - Wall time: 3-4 hours total

3. **Phase 1C (Blocked Wave 4)** - Execute after P0-0.2 complete
   - G1A/1B/1C/1D execute in parallel
   - Wall time: 4 hours (2 with parallelism)

4. **Phase 2 (Wave 5)** - Execute in parallel with Phase 1C
   - G2A-2F execute in parallel
   - Wall time: 6-8 hours (2-3 with parallelism)

5. **Phase 3 (Generalization)** - After Waves 4+5 complete
   - Sequential: 4-6 hours

6. **Phase 4 (Cleanup + Verification)** - After Wave 6 complete
   - Sequential: 3-4 hours

================================================================================
PROGRESS TRACKING
================================================================================

COMPLETED (Waves 1-3 + Phase 0):
  ✓ Wave 1-3: Dead code removal (299 files), code audit (156 files), architecture verification
  ✓ Phase 0: Foundation complete (Dialog Registry, List Grouping, Search, Components, Tags)
  ✓ Infrastructure: 5 new modules (dialog-engine.js, component-engine.js, global-tags.js updates)
  ✓ Config: 32 new definitions (24 dialogs + 8 components in master-config.yml)

CURRENT (Phase 1 - Feature Implementation):
  → PHASE 1A: Quick Wins (9 items, config-only, ~45 min)
  → PHASE 1B: Unblocked Wave 4 (15 items, independent, 2-3 hours)
  → PHASE 1C: Blocked Wave 4 (43 items, 4 parallel groups, 4-8 hours)
  → PHASE 2: Wave 5 (48 items, 6 parallel groups, 6-8 hours)
  → PHASE 3: Wave 6 (9 generalization items, 4-6 hours)
  → PHASE 4: Wave 7 (12 cleanup + verification items, 3-4 hours)

TOTAL REMAINING: 136 items (9+15+43+48+9+12)

Next action: Execute Phase 1A (Quick Wins) - add missing config entries
