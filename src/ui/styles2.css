/* Prevent horizontal overflow at page level */
html, body { overflow-x: hidden; max-width: 100%; }

/* Design tokens */
:root {
  --color-primary: #04141f;
  --color-primary-hover: #0a2535;
  --color-surface: #ffffff;
  --color-bg: #f1f5f9;
  --color-border: #e2e8f0;
  --color-text: #0f172a;
  --color-text-muted: #64748b;
  --color-text-light: #94a3b8;
  --color-success: #16a34a;
  --color-warning: #d97706;
  --color-danger: #dc2626;
  --color-info: #2563eb;
  --radius: 8px;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1), 0 4px 6px rgba(0,0,0,0.05);
}

/* Page layout */
.page-shell { background: var(--color-bg); min-height: calc(100vh - 56px); padding: 1rem 1.5rem; }
.page-shell-inner { width: 100%; }
.page-shell-flush { background: var(--color-bg); min-height: calc(100vh - 56px); padding: 0; }
.page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 28px; }
.page-title { font-size: 24px; font-weight: 700; color: var(--color-primary); letter-spacing: -0.3px; margin: 0; }
.page-subtitle { font-size: 14px; color: var(--color-text-muted); margin-top: 4px; }

/* Cards */
.card-clean { background: var(--color-surface); border-radius: var(--radius); box-shadow: var(--shadow-sm); border: 1px solid var(--color-border); }
.card-clean-body { padding: 24px; }
.card-section { margin-bottom: 24px; }

/* Table system */
.table-wrap { background: var(--color-surface); border-radius: var(--radius); box-shadow: var(--shadow-sm); border: 1px solid var(--color-border); overflow: hidden; }
.table-toolbar { display: flex; gap: 12px; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--color-border); flex-wrap: wrap; }
.table-search { flex: 1; min-width: 200px; position: relative; }
.table-search input { width: 100%; padding: 8px 12px 8px 36px; border: 1px solid var(--color-border); border-radius: 6px; font-size: 14px; outline: none; box-sizing: border-box; }
.table-search input:focus { border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(4,20,31,0.08); }
.table-search::before { content: 'üîç'; position: absolute; left: 10px; top: 50%; transform: translateY(-50%); font-size: 13px; pointer-events: none; }
.table-filter select { padding: 8px 12px; border: 1px solid var(--color-border); border-radius: 6px; font-size: 14px; background: white; cursor: pointer; outline: none; }
.table-filter select:focus { border-color: var(--color-primary); }
.table-count { font-size: 13px; color: var(--color-text-muted); white-space: nowrap; margin-left: auto; }
.data-table { width: 100%; border-collapse: collapse; }
.data-table th { padding: 12px 20px; text-align: left; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; color: var(--color-text-muted); background: #f8fafc; border-bottom: 1px solid var(--color-border); cursor: pointer; user-select: none; white-space: nowrap; }
.data-table th:hover { color: var(--color-primary); }
.data-table th.sort-asc::after { content: ' ‚Üë'; }
.data-table th.sort-desc::after { content: ' ‚Üì'; }
.data-table td { padding: 14px 20px; font-size: 14px; color: var(--color-text); border-bottom: 1px solid #f1f5f9; vertical-align: middle; }
.data-table tr:last-child td { border-bottom: none; }
.data-table tr:hover td { background: #f8fafc; }
.data-table .col-actions { text-align: right; white-space: nowrap; }

/* Badges / Pills */
.pill { display: inline-flex; align-items: center; padding: 3px 10px; border-radius: 100px; font-size: 12px; font-weight: 500; }
.pill-success { background: #dcfce7; color: #15803d; }
.pill-danger { background: #fee2e2; color: #b91c1c; }
.pill-warning { background: #fef3c7; color: #92400e; }
.pill-info { background: #dbeafe; color: #1d4ed8; }
.pill-neutral { background: #f1f5f9; color: #475569; }
.pill-primary { background: #e0f2fe; color: #0369a1; }

/* Stage pills */
.stage-pill { display: inline-flex; align-items: center; padding: 4px 12px; border-radius: 100px; font-size: 12px; font-weight: 600; letter-spacing: 0.2px; }
.stage-info_gathering { background: #fee2e2; color: #991b1b; }
.stage-commencement { background: #fef3c7; color: #92400e; }
.stage-team_execution { background: #dbeafe; color: #1e40af; }
.stage-partner_review { background: #ede9fe; color: #5b21b6; }
.stage-finalization { background: #dcfce7; color: #15803d; }
.stage-closeout { background: #f1f5f9; color: #475569; }

/* Buttons */
.btn-primary-clean { display: inline-flex; align-items: center; gap: 6px; padding: 9px 18px; background: var(--color-primary); color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; text-decoration: none; transition: background 0.15s; }
.btn-primary-clean:hover { background: var(--color-primary-hover); color: white; }
.btn-ghost-clean { display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: transparent; color: var(--color-text); border: 1px solid var(--color-border); border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; text-decoration: none; transition: all 0.15s; }
.btn-ghost-clean:hover { background: var(--color-bg); border-color: #94a3b8; }
.btn-danger-clean { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; background: transparent; color: var(--color-danger); border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; text-decoration: none; transition: all 0.15s; }
.btn-danger-clean:hover { background: #fee2e2; }
.btn-edit-clean { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; background: transparent; color: var(--color-info); border: 1px solid #bfdbfe; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; text-decoration: none; transition: all 0.15s; }
.btn-edit-clean:hover { background: #eff6ff; }

/* Tabs */
.tab-bar { display: flex; gap: 4px; padding: 4px; background: #f1f5f9; border-radius: 8px; margin-bottom: 24px; flex-wrap: wrap; }
.tab-btn { padding: 8px 16px; border: none; background: transparent; border-radius: 6px; font-size: 14px; font-weight: 500; color: var(--color-text-muted); cursor: pointer; transition: all 0.15s; white-space: nowrap; }
.tab-btn.active { background: white; color: var(--color-primary); box-shadow: var(--shadow-sm); font-weight: 600; }
.tab-btn:hover:not(.active) { color: var(--color-text); background: rgba(255,255,255,0.6); }
.tab-count { display: inline-flex; align-items: center; justify-content: center; min-width: 20px; height: 20px; padding: 0 6px; background: #e2e8f0; border-radius: 100px; font-size: 11px; font-weight: 700; margin-left: 6px; }
.tab-btn.active .tab-count { background: var(--color-primary); color: white; }

/* Stats row */
.stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; margin-bottom: 28px; }
.stat-card { background: white; border-radius: var(--radius); border: 1px solid var(--color-border); padding: 20px; box-shadow: var(--shadow-sm); }
.stat-card-clickable { cursor: pointer; transition: box-shadow 0.15s; }
.stat-card-clickable:hover { box-shadow: var(--shadow-md); }
.stat-card-value { font-size: 28px; font-weight: 700; color: var(--color-primary); line-height: 1; }
.stat-card-label { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; color: var(--color-text-muted); margin-top: 6px; }
.stat-card-sub { font-size: 12px; color: var(--color-text-light); margin-top: 4px; }

/* Breadcrumb */
.breadcrumb-clean { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--color-text-muted); margin-bottom: 20px; }
.breadcrumb-clean a { color: var(--color-text-muted); text-decoration: none; }
.breadcrumb-clean a:hover { color: var(--color-primary); }
.breadcrumb-sep { color: var(--color-text-light); }

/* Forms */
.form-shell { max-width: 860px; }
.form-section { background: white; border-radius: var(--radius); border: 1px solid var(--color-border); padding: 24px; margin-bottom: 20px; box-shadow: var(--shadow-sm); }
.form-section-title { font-size: 15px; font-weight: 600; color: var(--color-primary); margin: 0 0 20px 0; padding-bottom: 12px; border-bottom: 1px solid var(--color-border); }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.form-grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
.form-field { display: flex; flex-direction: column; gap: 6px; }
.form-field.full { grid-column: 1/-1; }
.form-label { font-size: 13px; font-weight: 600; color: var(--color-text); }
.form-label .req { color: var(--color-danger); margin-left: 2px; }
.form-input { padding: 9px 12px; border: 1px solid var(--color-border); border-radius: 6px; font-size: 14px; color: var(--color-text); outline: none; transition: border-color 0.15s, box-shadow 0.15s; width: 100%; box-sizing: border-box; background: white; }
.form-input:focus { border-color: var(--color-primary); box-shadow: 0 0 0 3px rgba(4,20,31,0.08); }
.form-hint { font-size: 12px; color: var(--color-text-muted); }
.form-actions { display: flex; gap: 12px; justify-content: flex-end; padding-top: 20px; margin-top: 4px; }

/* Sort/filter script injection marker */
.table-wrap .data-table { display: table; }

/* Overdue / status alerts */
.alert-strip { display: flex; align-items: center; justify-content: space-between; padding: 12px 20px; border-radius: var(--radius); margin-bottom: 20px; font-size: 14px; font-weight: 500; }
.alert-strip-danger { background: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5; }
.alert-strip-warning { background: #fef3c7; color: #92400e; border: 1px solid #fde68a; }

/* Nav: hide desktop links on mobile, show hamburger */
.nav-links-desktop { display: flex; }
.nav-hamburger { display: none; }
@media (max-width: 768px) {
  .nav-links-desktop { display: none !important; }
  .nav-hamburger { display: flex !important; }
}

/* Responsive */
@media (max-width: 768px) {
  .page-shell { padding: 0.75rem; }
  .page-shell-flush { padding: 0; }
  .form-grid, .form-grid-3 { grid-template-columns: 1fr; }
  .stats-row { grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
  .table-toolbar { flex-direction: column; align-items: stretch; padding: 1rem; }
  .table-search { min-width: unset; width: 100%; }
  .table-search input { font-size: 1rem; padding: 0.75rem 0.75rem 0.75rem 2.25rem; }
  .table-filter { width: 100%; }
  .table-filter select { width: 100%; min-height: 44px; }
  .data-table th, .data-table td { padding: 0.75rem; font-size: 0.875rem; }
  .data-table { min-width: unset; width: 100%; }
  .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .page-header { flex-direction: column; align-items: flex-start; gap: 0.75rem; }
  .page-title { font-size: 1.25rem; }
  .page-subtitle { font-size: 0.8125rem; }
  .card-clean { border-radius: 0; border-left: none; border-right: none; margin-left: -0.75rem; margin-right: -0.75rem; }
  .card-clean-body { padding: 1rem; }
  .form-section { border-radius: 0; border-left: none; border-right: none; margin-left: -0.75rem; margin-right: -0.75rem; padding: 1rem; }
  .form-shell { max-width: 100%; }
  .form-actions { flex-direction: column; gap: 0.5rem; }
  .form-actions .btn { width: 100%; justify-content: center; }
  .btn-primary-clean, .btn-ghost-clean { min-height: 44px; padding: 0.75rem 1rem; }
  .stat-card { padding: 1rem; }
  .stat-card-value { font-size: 1.5rem; }
  .stat-card-label { font-size: 0.625rem; }
  .breadcrumb-clean { font-size: 0.8125rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .tab-bar { overflow-x: auto; -webkit-overflow-scrolling: touch; flex-wrap: nowrap; padding: 0.5rem; scrollbar-width: none; }
  .tab-bar::-webkit-scrollbar { display: none; }
  .tab-btn { flex-shrink: 0; padding: 0.625rem 0.875rem; font-size: 0.875rem; }
  .alert-strip { flex-direction: column; gap: 0.5rem; text-align: center; padding: 1rem; }
  .table-count { text-align: center; margin-left: 0; margin-top: 0.5rem; }
  .form-label { font-size: 0.9375rem; }
  .form-input { min-height: 44px; font-size: 1rem; }
  .form-hint { font-size: 0.75rem; }
}

/* Tablet */
@media (min-width: 769px) and (max-width: 1023px) {
  .page-shell { padding: 1rem; }
  .stats-row { grid-template-columns: repeat(3, 1fr); }
  .card-clean { margin-left: 0; margin-right: 0; border-radius: var(--radius); }
  .form-grid { grid-template-columns: repeat(2, 1fr); }
}

/* Small mobile */
@media (max-width: 479px) {
  .page-shell { padding: 0.5rem; }
  .page-title { font-size: 1.125rem; }
  .stats-row { grid-template-columns: 1fr; }
  .stat-card { padding: 0.875rem; }
  .table-toolbar { padding: 0.75rem; }
  .card-clean-body { padding: 0.875rem; }
  .form-section { padding: 0.875rem; }
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
  .btn-primary-clean, .btn-ghost-clean, .btn-danger-clean, .btn-edit-clean {
    min-height: 44px;
    touch-action: manipulation;
  }
  .form-input, select, textarea {
    min-height: 44px;
    font-size: 16px; /* Prevents iOS zoom */
  }
  a, button, [role="button"] {
    min-height: 44px;
    min-width: 44px;
    touch-action: manipulation;
  }
  .data-table tr:hover td { background: transparent; }
  .table-hover tbody tr:hover { background: transparent; }
}

/* Safe area for notched phones */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  .page-shell {
    padding-bottom: calc(0.75rem + env(safe-area-inset-bottom));
  }
  .action-bar-mobile {
    padding-bottom: calc(0.75rem + env(safe-area-inset-bottom));
  }
}

/* Landscape mobile */
@media (max-height: 480px) and (orientation: landscape) {
  .modal-overlay, .confirm-overlay, .dialog-overlay {
    align-items: center;
    padding: 1rem;
  }
  .modal-dialog, .confirm-dialog, .modal-content, .dialog-panel {
    max-height: 80vh;
    border-radius: 0.5rem;
  }
}

/* Print */
@media print {
  .no-print { display: none !important; }
  .page-shell { padding: 0; }
  .card-clean, .table-wrap { box-shadow: none; border: 1px solid #ccc; }
}
